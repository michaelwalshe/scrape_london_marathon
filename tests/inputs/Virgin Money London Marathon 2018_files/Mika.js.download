/*
 * ....................NNN..NNN................................
 * ....................NNN..NNN................................
 * .........................NNN............. ..................
 * .NNNNNNNNNNNNNNNN...NNN..NNN..NNNN.. NNNNNNNNNN..NNN........
 * .NNN ..ZNNN,...NNN .NNN..NNN.NNN:...NNN .. NNNN. NNN........
 * .NNM....NNN....NNN..NNN..NNNNNN....NNN......NNN.............
 * .NNN....NNN....NNN..NNN..NNNNNNN...NNN......NNN.............
 * .NNN....NNN....NNN..NNN..NNN..NNN ..NNN .. NNNN.............
 * .NNN....NNN....NNN..NNN..NNN...NNN..ONNNNNNNNNN..NNN........
 * .NNN....NNN....NNN..MNN..NNN....NNN7...NNN .NND. NNM........
 * ............................................................
 * NNNNNN. NNN..NNDDNNNN 8NNNNN... NNN .NN=NNNNN......NNNNN.NNN
 * NNNNNN..NNN..NNNNDNNNNNNNNNNN,. NNN..NNNNNMNNN...NNNNNNNNNNN
 * .NNN....NNN..NNN....NNN.. .NNN. NNN..NND....NNN.MNN ....MNNN
 * .NNN....NNN..NNN....NNN....NNN. NNN..NNN....NNN.NNN......NNN
 * .NNN....NNN..NNN....NNN....NNN. NNN..NNN....NNN.NNN ....DNNN
 * .NNNNN..NNN..NNN....NNN....NNN. NNN..NNN....NNN..NNNN .NNNNN
 * ..NNNN..NNN..NNN....NNN....NNN. NNN..NNN....NNN...MNNNNN8NNN
 * .........................................................NN.
 * ................................................?NNN  . NNN.
 * .................................................+NNNNNNNN..
 * .....................................................NN.....
 * @package    Mika
 * @author     Mika Timing GmbH <info@mikatiming.de>
 * @copyright  2021 Mika Timing GmbH
 */

define("Mika/Logger",["module"],function(e){var t,i=e.config().debug,a=function(){var e=function(e,t){if(!0===i&&"undefined"!=typeof console)if(void 0!==console[e])console[e].apply(console,t);else{var a="Method "+e+" is not supported by this browser!";void 0!==console.error?console.error(a):console.log("Error: "+a)}};return i&&e("log",["%c  %c Debug activated!",'background-image: url("//assets.r.mikatiming.de//static/img/iex/o/svg/blue_dark_grey//debug.svg"); background-size: cover; color: #1CEA2F;',"color: #000; font-weight: bolder;"]),{log:function(){return!!i&&e("log",arguments)},error:function(){return!!i&&e("error",arguments)},info:function(){return!!i&&e("info",arguments)},warn:function(){return!!i&&e("warn",arguments)},assert:function(){return!!i&&e("assert",arguments)},clear:function(){return!!i&&e("clear",arguments)},count:function(){return!!i&&e("count",arguments)},dir:function(){return!!i&&e("dir",arguments)},dirxml:function(){return!!i&&e("dirxml",arguments)},group:function(){return!!i&&e("group",arguments)},groupEnd:function(){return!!i&&e("groupEnd",arguments)},groupCollapsed:function(){return!!i&&e("groupCollapsed",arguments)},profile:function(){return!!i&&e("profile",arguments)},profileEnd:function(){return!!i&&e("profileEnd",arguments)},table:function(){return!!i&&e("table",arguments)},time:function(){return!!i&&e("time",arguments)},timeEnd:function(){return!!i&&e("timeEnd",arguments)},timeline:function(){return!!i&&e("timeline",arguments)},timelineEnd:function(){return!!i&&e("timelineEnd",arguments)},timeStamp:function(){return!!i&&e("timeStamp",arguments)},trace:function(){return!!i&&e("trace",arguments)},isDebug:function(){return i}}};return function(e){return t||(t=new a),t}}),define("Mika/Tools",["Mika/Logger","Mika/Map/LatLng","lodashIsEqual","module"],function(e,t,i,a){(new e).info("initialized: "+a.id);var r;return function(){var e=function(e){return e/(Math.PI/180)},a=function(e){return Math.PI/180*e};return{browser:function(){if(!r){ua=navigator.userAgent.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];r={browser:e[1]||"",version:e[2]||"0"}}return r},microtime:function(){return(new Date).getTime()},getClientSeconds:function(){var e=new Date,t=3600*e.getHours();return t+=60*e.getMinutes(),t+=e.getSeconds()},ms2time:function(e,t){void 0===t&&(t=!1);var i,a,r,n,o;return e<0?(e*=-1,i="-"):i="",o=Math.ceil(e/1e3),n=o/60,r=n/60,a=r/24,n>=1?(n=Math.floor(n),o-=60*n):n=0,r>=1?(r=Math.floor(r),n-=60*r):r=0,a>=1?(a=Math.floor(a),r-=24*a):a=0,r<10&&(r="0"+r),n<10&&(n="0"+n),o<10&&(o="0"+o),a?i+a+r+":"+n+":"+o:t?i+n+":"+o:i+r+":"+n+":"+o},sortObjByKey:function(e,t){var i,a=[],r={};for(i in e)a.push(i);t?a.sort(function(e,t){return e-t}):a.sort();for(i in a)r[a[i]]=e[a[i]];return r},deepCompareObjects:i,identify:function(e){if(jQuery(e).attr("id"))return jQuery(e).attr("id");var t,i=0;do{t="identified_"+ ++i}while(jQuery("#"+t).length>0);return jQuery(e).attr("id",t),t},getQueryString:function(){for(var e=window.location.search.substr(1).split("&"),t={},i=0;i<e.length;i++){var a=e[i].split("=");2==a.length&&(t[a[0]]=decodeURIComponent(a[1].replace(/\+/g," ")))}return t},removeParameterFromUrl:function(e){if(void 0!==window.history&&"function"==typeof window.history.replaceState){var t=this.getQueryString();void 0!==t[e]&&(delete t[e],history.replaceState(history.state,window.title,location.protocol+"//"+location.host+location.pathname+"?"+jQuery.param(t)))}},getHashLength:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;return t},generateGuid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},svg:{wrapText:function(e,t,i){void 0===i&&(i=!1);var a=e;try{e.each(function(){for(var e,r=d3.select(this),n=r.text().split(/\s+/).reverse(),o=[],d=0,l=r.attr("y"),s=parseFloat(r.attr("dy")),u=r.text(null).append("tspan").attr("x",r.attr("x")).attr("y",l).attr("dy",s+"em");e=n.pop();)o.push(e),u.text(o.join(" ")),u.node().getComputedTextLength()>t&&o.length>1&&(o.pop(),u.text(o.join(" ")),o=[e],u=r.append("tspan").attr("x",r.attr("x")).attr("y",l).attr("dy",1*++d+s+"em").text(e));if(i){var c=d3.select(this).selectAll("tspan");1===c[0].length&&d3.select(a[0][0].parentNode).select("circle")&&c.attr("y",d3.select(a[0][0].parentNode).select("circle").attr("cy")/2+3)}})}catch(e){}}},color:{hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},getComplimentaryColor:function(e){var t=0;for(var i in e)t=Math.max(e[i],t);return{r:Math.max(t-e.r,0),g:Math.max(t-e.g,0),b:Math.max(t-e.b,0)}},rgbToHex:function(e){var t=function(e){var t=e.toString(16);return 1==t.length?"0"+t:t};return"#"+t(e.r)+t(e.g)+t(e.b)}},colorStringToBootstrapClass:function(e,t){var i;switch(e){case"green":i="success";break;case"blue":i="info";break;case"yellow":i="warning";break;case"red":i="danger";break;default:i=void 0!==t&&t}return i},loadCss:function(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},parseBool:function(e){if(null==e)return!1;if("boolean"==typeof e)return 1==e;if("string"==typeof e){if(""==(e=e.replace(/^\s+|\s+$/g,"")))return!1;if("true"==e.toLowerCase()||"yes"==e.toLowerCase())return!0}return!isNaN(e)&&0!=parseFloat(e)},rad2deg:e,deg2rad:a,each:function(e,t,i){if(e){var a;if(void 0!==e.length){for(a=0;a<e.length;a++)if(!1===t.call(i,e[a],a))return}else for(a in e)if(e.hasOwnProperty(a)&&!1===t.call(i,e[a],a))return}},geo:{computeHeading:function(t,i){var a=Math.PI/180*t.lat(),r=Math.PI/180*i.lat(),n=Math.PI/180*i.lng()-Math.PI/180*t.lng();return function(t,i,o){return o-=-180,((e(Math.atan2(Math.sin(n)*Math.cos(r),Math.cos(a)*Math.sin(r)-Math.sin(a)*Math.cos(r)*Math.cos(n)))- -180)%o+o)%o-180}(0,0,180)},calculateDistanceBetweenPoints:function(e,t){if(!e||!t)return 0;var i=(t.lat()-e.lat())*Math.PI/180,a=(t.lng()-e.lng())*Math.PI/180,r=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(t.lat()*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371},computeOffset:function(i,r,n,o){r/=o||6378137,n=a(n);var d=a(i.lat());o=Math.cos(r),r=Math.sin(r);var l=Math.sin(d),s=o*l+r*(d=Math.cos(d))*Math.cos(n);return new t(e(Math.asin(s)),e(a(i.lng())+Math.atan2(r*d*Math.sin(n),o-l*s)))}},dom:{query:function(e,t){return void 0!==document.querySelector?void 0===t?document.querySelector(e):t.querySelector(e):void 0===t?jQuery(e)[0]:jQuery(t).find(e)[0]},queryAll:function(e,t){return void 0!==document.querySelectorAll?void 0===t?document.querySelectorAll(e):t.querySelectorAll(e):void 0===t?jQuery(e):jQuery(t).find(e)},hasClass:function(e,t){return void 0!==e.classList?e.classList.contains(t):void 0!==e.className&&-1!==e.className.indexOf(t)},addClass:function(e,t){if(void 0!==t&&null!=t&&""!=t){var i=t.trim();if(""!=i){var a=i.split(" ");for(var r in a){var n=a[r];void 0!==e.classList?e.classList.add(n):this.hasClass(e,n)||(e.className+=" "+n)}}}},removeClass:function(e,t){var i=t.split(" ");for(var a in i){var r=i[a];void 0!==e.classList?e.classList.remove(r):e.className=e.className.replace(new RegExp(r,"g"),"")}},toggleClass:function(e,t){this.hasClass(e,t)?this.removeClass(e,t):this.addClass(e,t)},position:function(e){for(var t=left=0;e;)e.tagName?(t+=e.offsetTop,left+=e.offsetLeft,e=e.offsetParent):e=e.parentNode;return{top:t,left:left}},closest:function(e,t){if(void 0!==e.matches){for(;e;){if(e.matches(t))return e;e=e.parentElement}return null}return jQuery(e).closest(t)[0]}},animate:function(e){function t(n){if(!1!==i){r(t);n=new Date;i=e(n-a),a=new Date}}var i,a=+new Date,r=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;t(a)}}}}),define("Mika/Environment",["Mika/Logger","module"],function(e,t){(new e).info("initialized: "+t.id);var i=!!navigator.userAgent.match(/(iPhone|iPod)/g),a=!!navigator.userAgent.match(/iPad/g),r=!(!navigator.userAgent.match(/Android/g)||!navigator.userAgent.match(/Mobile/g)),n=!(!navigator.userAgent.match(/Android/g)||navigator.userAgent.match(/Mobile/g)),o=!!navigator.userAgent.match(/Edge/g),d=navigator.userAgent.substr(navigator.userAgent.indexOf("Windows"),15);d=d.replace(/\D/g,"");var l=!!(navigator.userAgent.match(/Trident.*rv\:11\./)&&d>61),s=navigator.userAgent.substr(navigator.userAgent.indexOf("Firefox"),10);s=s.replace(/\D/g,"");var u={},c=function(e){return void 0!==u[e]&&u[e]};c.add=function(e,t){u[e]=t};var g=navigator,f=g.userAgent,m=g.appVersion,p=parseFloat(m);if(c.add("air",f.indexOf("AdobeAIR")>=0),c.add("wp",parseFloat(f.split("Windows Phone")[1])||void 0),c.add("msapp",parseFloat(f.split("MSAppHost/")[1])||void 0),c.add("khtml",m.indexOf("Konqueror")>=0?p:void 0),c.add("webkit",!c("wp")&&parseFloat(f.split("WebKit/")[1])||void 0),c.add("chrome",parseFloat(f.split("Chrome/")[1])||void 0),c.add("android",!c("wp")&&parseFloat(f.split("Android ")[1])||void 0),c.add("safari",m.indexOf("Safari")>=0&&!c("wp")&&!c("chrome")&&!c("android")?parseFloat(m.split("Version/")[1]):void 0),c.add("mac",m.indexOf("Macintosh")>=0),c.add("quirks","BackCompat"==document.compatMode),!c("wp")&&f.match(/(iPhone|iPod|iPad)/)){var h=RegExp.$1.replace(/P/,"p"),v=f.match(/OS ([\d_]+)/)?RegExp.$1:"1",y=parseFloat(v.replace(/_/,".").replace(/_/g,""));c.add(h,y),c.add("ios",y)}if(c.add("bb",(f.indexOf("BlackBerry")>=0||f.indexOf("BB10")>=0)&&parseFloat(f.split("Version/")[1])||void 0),c.add("trident",parseFloat(m.split("Trident/")[1])||void 0),c.add("svg","undefined"!=typeof SVGAngle),!c("webkit")){if(f.indexOf("Opera")>=0&&c.add("opera",p>=9.8?parseFloat(f.split("Version/")[1])||p:p),!(f.indexOf("Gecko")>=0)||c("wp")||c("khtml")||c("webkit")||c("trident")||c.add("mozilla",p),c("mozilla")&&c.add("ff",parseFloat(f.split("Firefox/")[1]||f.split("Minefield/")[1])||void 0),document.all&&!c("opera")?isIE=parseFloat(m.split("MSIE ")[1])||void 0:m.indexOf("Trident")&&(isIE=parseFloat(m.split("rv:")[1])||void 0),document.all&&!c("opera")){var w=document.documentMode;w&&5!=w&&Math.floor(isIE)!=w&&(isIE=w)}c.add("ie",isIE),c.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return{browser:c,isMobile:function(){return i||a||r||n},isIphone:function(){return i},isIpad:function(){return a},isAndroidPhone:function(){return r},isAndroidTablet:function(){return n},isEdge:function(){return o},isIE11GreaterWin7:function(){return l},ffVersion:function(){return s},getDisplayWidthType:function(){var e=window.innerWidth;return e<768?"xs":e<992?"sm":e<1200?"md":e>=1200?"lg":void 0}}}),define("Mika/Dialog",["Mika/Logger","module"],function(e,t){(a=new e).info("initialized: "+t.id);var i={url:null,loadingTitle:"Loading...",dialogTitle:null,identifier:Math.random()*Math.random()*Math.random(),"post-action":null,"close-action":"reload","update-dialog-identifier":null,forceRecreate:!1,headless:!1,footerContent:"",strings:{yes:"YES",no:"NO","please.confirm":"Please Confirm!"}},a=new e,r={},n=function(e){var t=function(e){var t={};for(var a in i)jQuery(e).attr("data-"+a)&&(t[a]=jQuery(e).attr("data-"+a));return t};jQuery(e).find(".mika-dialog[data-url]").click(function(){l(jQuery.extend(!0,{},i,t(this)))}),jQuery(e).find(".mika-dialog-confirm[data-question]").click(function(){g(jQuery(this).attr("data-question"),jQuery.extend(!0,{},i,t(this)))})};n("body");var o=function(e){return!(!r[e.identifier]||!0===e.forceRecreate)||(r[e.identifier]&&e.forceRecreate&&(jQuery(r[e.identifier]).remove(),delete r[e.identifier]),d(e),!1)},d=function(e){a.log("creating dialog",e),r[e.identifier]=document.createElement("div"),r[e.identifier].className="modal fade",document.getElementsByTagName("body")[0].appendChild(r[e.identifier]);var t=document.createElement("div");t.className="modal-dialog modal-lg",e.width&&(t.style.width=e.width+"px"),r[e.identifier].appendChild(t);var i=document.createElement("div");if(i.className="modal-content",t.appendChild(i),!0!==e.headless){var n=document.createElement("div");n.className="modal-header",i.appendChild(n);var o=document.createElement("button");o.type="button",o.className="close",o.setAttribute("data-dismiss","modal"),o.innerHTML="<span>&times;</span>",n.appendChild(o);var d=document.createElement("h4");d.className="modal-title",d.innerHTML=e.dialogTitle,n.appendChild(d)}var l=document.createElement("div");if(l.className="modal-body",i.appendChild(l),"undefined"!=e.footerContent&&""!==e.footerContent&&null!==e.footerContent){var s=document.createElement("div");s.className="modal-footer",s.innerHTML=e.footerContent,i.appendChild(s)}jQuery(r[e.identifier]).on("hide.bs.modal",function(){if("function"==typeof e["close-action"])e["close-action"](r[e.identifier]);else switch(e["close-action"]){case"update-dialog":e["update-dialog-identifier"]&&c(e["update-dialog-identifier"]);break;case"nothing":break;default:case"reload":document.location.reload()}setTimeout(function(){jQuery(r[e.identifier]).remove(),delete r[e.identifier]},300),jQuery("body").removeClass("modal-open")})},l=function(e){var t=new jQuery.Deferred,a=jQuery.extend(!0,{},i,e),n=o(a),d=jQuery(r[a.identifier]).find(".modal-dialog"),l=jQuery(r[a.identifier]).find(".modal-title"),u=jQuery(r[a.identifier]).find(".modal-body"),c=function(){jQuery(d).removeClass("modal-lg").addClass("modal-sm"),jQuery(r[a.identifier]).attr("data-url",a.url),l.length>0&&jQuery(l).html(a.loadingTitle),jQuery(u).html('<div class="progress"><div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" style="width: 100%"></div></div>'),jQuery(r[a.identifier]).modal("show")};return n?setTimeout(function(){"pending"==t.state()&&c()},300):c(),jQuery.get(a.url,function(e,i,o){jQuery(d).removeClass("modal-sm").addClass("modal-lg"),null===a.dialogTitle&&(a.dialogTitle=decodeURIComponent(o.getResponseHeader("X-MikaDialogTitle"))),s(e,a).then(function(e){t.resolve(e)}),n&&t.resolve(r[a.identifier])}),t.promise()},s=function(e,t){a.group("showing dialog"),a.log(t),a.groupEnd();var d=new jQuery.Deferred,l=jQuery.extend(!0,{},i,t),s=o(l),u=(jQuery(r[l.identifier]).find(".modal-dialog"),jQuery(r[l.identifier]).find(".modal-title")),c=jQuery(r[l.identifier]).find(".modal-body");return l.url&&jQuery(r[l.identifier]).attr("data-url",l.url),u.length>0&&jQuery(u).html(l.dialogTitle),jQuery(c).html(e),n(r[l.identifier]),jQuery(r[l.identifier]).on("shown.bs.modal",function(){d.resolve(r[l.identifier])}),jQuery(r[l.identifier]).modal("show"),setTimeout(function(){"pending"==d.state()&&d.resolve(r[l.identifier])},300),s&&jQuery(r[l.identifier]).css("display","block"),d.promise()},u=function(e,t,i){var a=jQuery(r[t.identifier]).find(".modal-dialog"),o=jQuery(r[t.identifier]).find(".modal-title"),d=jQuery(r[t.identifier]).find(".modal-body"),l=jQuery(r[t.identifier]).find(".modal-footer");if(void 0!==t.footerContent&&""!==t.footerContent&&null!==t.footerContent){if(1!=l.length){var s=document.createElement("div");s.className="modal-footer",jQuery(r[t.identifier]).find(".modal-content").append(s),l=jQuery(r[t.identifier]).find(".modal-footer")}l.html(t.footerContent)}a.removeClass("modal-sm").addClass("modal-lg"),void 0!==t.append&&!0===t.append?d.append(e):d.html(e),t.url&&jQuery(r[t.identifier]).attr("data-url",t.url),t.width&&a.width(t.width),t.dialogTitle&&o.length>0&&o.html(t.dialogTitle),n(r[t.identifier]),"function"==typeof i&&i(r[t.identifier])},c=function(e){if(void 0!==r[e]){var t=jQuery(r[e]).attr("data-url");t&&jQuery.get(t,function(t){u(t,{identifier:e})})}},g=function(e,t){var a=jQuery.extend(!0,{},i,t);a.dialogTitle=a.strings["please.confirm"],a.footerContent="buttons",d(a);var n=jQuery(r[a.identifier]).find(".modal-dialog"),o=jQuery(r[a.identifier]).find(".modal-body"),l=jQuery(r[a.identifier]).find(".modal-footer");l.html(""),jQuery(n).removeClass("modal-lg").addClass("modal-sm"),jQuery(o).html(e);var s=document.createElement("button");s.type="button",s.style.marginRight="5px",s.className="btn btn-success",s.innerHTML='<span class="glyphicon glyphicon-ok-circle"></span> '+a.strings.yes,s.onclick=function(){jQuery(this).mikaButton("loading"),jQuery(this.parentNode).find(".btn:not(.loading)").addClass("disabled").attr("disabled",!0),""!==a.url&&null!==a.url?jQuery.post(a.url,function(e){switch(a["post-action"]){case"update-dialog":a["update-dialog-identifier"]&&c(a["update-dialog-identifier"]);break;case"update-dialog-with-returned-content":a["update-dialog-identifier"]&&u(e,{identifier:a["update-dialog-identifier"]});break;case"nothing":break;default:case"reload":document.location.reload()}jQuery(r[a.identifier]).modal("hide")}):"function"==typeof a.callback&&a.callback()},jQuery(l).append(s);var g=document.createElement("button");g.type="button",g.className="btn btn-danger",g.innerHTML='<span class="glyphicon glyphicon-remove-circle"></span> '+a.strings.no,g.onclick=function(){jQuery(this).closest(".modal").modal("hide")},jQuery(l).append(g),jQuery(r[a.identifier]).modal("show")};return{confirmDialog:g,show:s,loadAndShow:l,update:u,showLoading:function(e){var t=new jQuery.Deferred,a=jQuery.extend(!0,{},i,e),n=o(a),d=jQuery(r[a.identifier]).find(".modal-dialog"),l=jQuery(r[a.identifier]).find(".modal-title"),s=jQuery(r[a.identifier]).find(".modal-body");return jQuery(d).removeClass("modal-lg").addClass("modal-sm"),jQuery(r[a.identifier]).attr("data-url",a.url),l.length>0&&jQuery(l).html(a.loadingTitle),jQuery(s).html('<div class="progress"><div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" style="width: 100%"></div></div>'),jQuery(r[a.identifier]).on("shown.bs.modal",function(){t.resolve(r[a.identifier])}),jQuery(r[a.identifier]).modal("show"),n&&setTimeout(function(){"pending"==t.state()&&t.resolve()},300),t.promise()},visible:function(e){return void 0!==r[e]},get:function(e){return r[e]},hide:function(e){void 0!==r[e]&&jQuery(r[e]).modal("hide")}}}),define("Mika/Environment",["Mika/Logger","module"],function(e,t){(new e).info("initialized: "+t.id);var i=!!navigator.userAgent.match(/(iPhone|iPod)/g),a=!!navigator.userAgent.match(/iPad/g),r=!(!navigator.userAgent.match(/Android/g)||!navigator.userAgent.match(/Mobile/g)),n=!(!navigator.userAgent.match(/Android/g)||navigator.userAgent.match(/Mobile/g)),o=!!navigator.userAgent.match(/Edge/g),d=navigator.userAgent.substr(navigator.userAgent.indexOf("Windows"),15);d=d.replace(/\D/g,"");var l=!!(navigator.userAgent.match(/Trident.*rv\:11\./)&&d>61),s=navigator.userAgent.substr(navigator.userAgent.indexOf("Firefox"),10);s=s.replace(/\D/g,"");var u={},c=function(e){return void 0!==u[e]&&u[e]};c.add=function(e,t){u[e]=t};var g=navigator,f=g.userAgent,m=g.appVersion,p=parseFloat(m);if(c.add("air",f.indexOf("AdobeAIR")>=0),c.add("wp",parseFloat(f.split("Windows Phone")[1])||void 0),c.add("msapp",parseFloat(f.split("MSAppHost/")[1])||void 0),c.add("khtml",m.indexOf("Konqueror")>=0?p:void 0),c.add("webkit",!c("wp")&&parseFloat(f.split("WebKit/")[1])||void 0),c.add("chrome",parseFloat(f.split("Chrome/")[1])||void 0),c.add("android",!c("wp")&&parseFloat(f.split("Android ")[1])||void 0),c.add("safari",m.indexOf("Safari")>=0&&!c("wp")&&!c("chrome")&&!c("android")?parseFloat(m.split("Version/")[1]):void 0),c.add("mac",m.indexOf("Macintosh")>=0),c.add("quirks","BackCompat"==document.compatMode),!c("wp")&&f.match(/(iPhone|iPod|iPad)/)){var h=RegExp.$1.replace(/P/,"p"),v=f.match(/OS ([\d_]+)/)?RegExp.$1:"1",y=parseFloat(v.replace(/_/,".").replace(/_/g,""));c.add(h,y),c.add("ios",y)}if(c.add("bb",(f.indexOf("BlackBerry")>=0||f.indexOf("BB10")>=0)&&parseFloat(f.split("Version/")[1])||void 0),c.add("trident",parseFloat(m.split("Trident/")[1])||void 0),c.add("svg","undefined"!=typeof SVGAngle),!c("webkit")){if(f.indexOf("Opera")>=0&&c.add("opera",p>=9.8?parseFloat(f.split("Version/")[1])||p:p),!(f.indexOf("Gecko")>=0)||c("wp")||c("khtml")||c("webkit")||c("trident")||c.add("mozilla",p),c("mozilla")&&c.add("ff",parseFloat(f.split("Firefox/")[1]||f.split("Minefield/")[1])||void 0),document.all&&!c("opera")?isIE=parseFloat(m.split("MSIE ")[1])||void 0:m.indexOf("Trident")&&(isIE=parseFloat(m.split("rv:")[1])||void 0),document.all&&!c("opera")){var w=document.documentMode;w&&5!=w&&Math.floor(isIE)!=w&&(isIE=w)}c.add("ie",isIE),c.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return{browser:c,isMobile:function(){return i||a||r||n},isIphone:function(){return i},isIpad:function(){return a},isAndroidPhone:function(){return r},isAndroidTablet:function(){return n},isEdge:function(){return o},isIE11GreaterWin7:function(){return l},ffVersion:function(){return s},getDisplayWidthType:function(){var e=window.innerWidth;return e<768?"xs":e<992?"sm":e<1200?"md":e>=1200?"lg":void 0}}}),define("Mika/Popover",["Mika/Environment","Mika/Logger","module"],function(e,t,i){(new t).info("initialized: "+i.id);var a={url:null,loadingTitle:"Loading...",target:"body","single-within-identifier":null,animation:!0,content:"",delay:0,html:!1,placement:"right",selector:!1,title:"",trigger:"click",viewport:{selector:"body",padding:0}};jQuery("body").find(".mika-popover[data-url]").click(function(e){0===jQuery(this).find(".popover").length&&n(jQuery.extend({},a,{target:this},function(e){var t={};for(var i in a)jQuery(e).attr("data-"+i)&&(t[i]=jQuery(e).attr("data-"+i));return t}(this)))}),e.isMobile()||(jQuery("body").find(".tt-help").each(function(){jQuery(this).attr("data-content",jQuery(this).attr("title")),jQuery(this).attr("title",null),jQuery(this).popover({tooltipClass:"tooltip-help",delay:jQuery(this).attr("data-delay")?jQuery(this).attr("data-delay"):400,placement:jQuery(this).attr("data-placement")?jQuery(this).attr("data-placement"):"auto top",trigger:jQuery(this).attr("data-trigger")?jQuery(this).attr("data-trigger"):"hover focus",container:"body"})}),jQuery("body").find('[data-toggle="popover-by-title"]').each(function(){jQuery(this).attr("data-content",jQuery(this).attr("title")),jQuery(this).attr("title",null),jQuery(this).popover({tooltipClass:"tooltip-help",delay:jQuery(this).attr("data-delay")?jQuery(this).attr("data-delay"):400,placement:jQuery(this).attr("data-placement")?jQuery(this).attr("data-placement"):"top",trigger:jQuery(this).attr("data-trigger")?jQuery(this).attr("data-trigger"):"hover focus",container:"body"})}));var r=function(e){var t=jQuery(e.target).find(".popover");t.length>0&&t.popover("destroy"),null!==e["single-within-identifier"]&&(t=jQuery("body").find('.mika-popover[data-single-within-identifier="'+e["single-within-identifier"]+'"] .popover')).length>0&&t.popover("destroy");var i=document.createElement("div");return jQuery(e.target).append(i),i},n=function(e){var t=jQuery.extend({},a,e,{content:'<div class="progress"><div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" style="width: 100%"></div></div>',html:!0,title:a.loadingTitle}),i=r(t);jQuery(i).popover(t).popover("show"),jQuery.get(t.url,function(e,i,a){t.title=a.getResponseHeader("X-MikaPopoverTitle"),t.content=e,o(t)})},o=function(e){var t=jQuery.extend({},a,e),i=r(t);jQuery(i).popover(t).popover("show")};return{show:o,loadAndShow:n}}),define("Mika/ImageErrorHandler",["Mika/Dialog","Mika/Logger","Mika/Mika","Mika/Tools","module"],function(e,t,i,a,r){(new t).info("initialized: "+r.id);var n={},o=new i,d=new a,l=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},s=function(e){if(!n[e].generate_src_url)throw new Error('Failed to handle image error for "'+n[e].generate_src_url+'"');var t=new XMLHttpRequest;t.open("GET",n[e].generate_src_url,!0),t.setRequestHeader("X-RequestedBy","ImageErrorHandler"),t.addEventListener("error",function(t){throw new Error('Failed to handle image error for "'+n[e].hash+'"')}),t.send()},u=function(t){var i=document.createElement("div");i.className="icon loading xxl",i.style.width="80px",i.style.marginLeft="auto",i.style.marginRight="auto";var a=d.dom.query("img[data-generate-src-url='"+n[t].generate_src_url+"']");if("thumb"==l("t",n[t].generate_src_url)||"timeflow"==l("t",n[t].generate_src_url))a.src=o.getOption("pathIcons")+"/icons/loading.svg",d.dom.addClass(d.dom.closest(a,"a"),i.className),d.dom.closest(a,"a")&&d.dom.query(".generate-src-loading-text",d.dom.closest(a,"a"))&&d.dom.removeClass(d.dom.query(".generate-src-loading-text",d.dom.closest(a,"a")),"hide");else if("detail"==l("t",n[t].generate_src_url)){var r=d.dom.query(".main-image");if(r){var s='<div class="detail-load-icon" style="width: '+r.clientWidth+"px; height: "+r.clientHeight+'px; display: table;"><div style="width: 100%; height: 100%; background: white; opacity: 0.3;"></div><div class="icon loading" style="display: table-cell; text-align: center; vertical-align: middle; margin-left: auto; margin-right: auto; "><img width="'+r.clientWidth+'" height="80" src="'+o.getOption("pathIcons")+'/icons/loading.svg" alt="" /></div></div>';d.dom.addClass(d.dom.query(".main-image"),"hide"),e.update(s,{identifier:"imageViewer-detail_photos",append:!0})}}},c=function(e){var t=d.dom.query("img[data-generate-src-url='"+e.generate_src_url+"']");t&&(d.dom.closest(t,"a.icon.loading.xxl")&&d.dom.removeClass(d.dom.closest(t,"a.icon.loading.xxl"),"icon loading xxl"),d.dom.query(".generate-src-loading-text",d.dom.closest(t,"a"))&&d.dom.addClass(d.dom.query(".generate-src-loading-text",d.dom.closest(t,"a")),"hide"),t.setAttribute("src",e.original_src),setTimeout(function(){d.dom.addClass(t,"show")},100))};return{statusMissingImage:function(e){return n.hasOwnProperty(e)},queueImageGeneration:function(e,t,i){return n.hasOwnProperty(t)||(n[t]={generate_src_url:e,original_src:i},s(t)),u(t),Object.keys(n).length},statusMissingImages:function(e){var t=new jQuery.Deferred;return function e(i,a){if(i<=1||a){var r=new FormData;r.append("missingImages",JSON.stringify(n));var o=new XMLHttpRequest;o.open("POST","index.php?content=photo&action=statusImageGenerate"),o.onload=function(){try{var i=JSON.parse(this.responseText);i.length>0&&jQuery.each(i,function(e,t){n.hasOwnProperty(t.hash)&&(c(n[t.hash]),delete n[t.hash])}),void 0!==n&&Object.keys(n).length>0?setTimeout(function(){e(Object.keys(n).length,!0)},1e3):t.resolve()}catch(e){return}},o.send(r)}}(e,!1),t.promise()}}}),define("Mika/ImageViewer",["Mika/Dialog","Mika/Logger","Mika/Mika","Mika/Sharer/Sharer","Mika/Tools","module","Mika/ImageErrorHandler"],function(e,t,i,a,r,n,o){var d=new t;d.info("initialized: "+n.id);var l=new i,s=new r,u={},c={},g=function(e,t){var i=c[e];"next"==t?++i==u[e].length&&(i=0):"previous"==t&&--i<0&&(i=u[e].length-1),p(u[e][i])},f=function(e){return"imageViewer-"+e.category},m=function(t){c[t.category]=t.sort;var i=Math.min(window.innerWidth,t.width/t.imagePixelRatio)-34-19,r="";r+='<a class="img" href="javascript:void(0);">',r+='<img class="main-image img-responsive"  src="'+t.url+'"  data-image-hash="'+t.imageHash+'" data-generate-src-url="'+t.link_generate_src+'" onerror="mikaImageErrorHandler(this)">',r+="</a>";var o="";if(t.timeflow){var d=JSON.parse(t.timeflow);d.length>0&&(o+='<div class="image-timeflow"><ul>',s.each(d,function(e,t){var i="";1==e.main&&(i="active"),o+='<li data-toggle="tooltip" data-placement="top" title="'+e.recordTime+'" class="'+i+'" data-detail-gen-hash="'+e.linkGenerationSrcHash+'" data-image-viewer-category="detail_photos" data-image-viewer-show-timeflowimage="'+e.linkGenerationSrcUrl+'" data-image-viewer-download-timeflowimage="'+e.download+'"><a href="javascript:void(0)"><img src="'+e.preview+'" data-image-hash="'+e.linkGenerateSrcHashThumb+'"  data-generate-src-url="'+e.generationSrcUrl+'" onerror="mikaImageErrorHandler(this)"></a></li>'}),o+="<li></li></ul></div>")}o+='<div class="image-viewer-options" style="width: '+i+'px;"><ul>',u[t.category].length>1&&(o+='<li class="controls">',o+='<span class="btn btn-default icon l" data-image-viewer-navigation-link="previous" title="previous image"><img src="'+l.getOption("pathIcons")+'/icons/navigate_left.svg" alt="previous image"></span>',o+='<span class="btn btn-default icon l" data-image-viewer-navigation-link="next" title="next image"><img src="'+l.getOption("pathIcons")+'/icons/navigate_right.svg" alt="next image"></span>',o+="</li>"),t.downloadUrl&&(o+='<li class="download"><a class="photo-download-action" onclick="ga_track.push([\'_trackEvent\',\''+l.getOption("global_event_id")+"_Features' , 'download_"+t.category+'\']);" href="'+t.downloadUrl+'"><span class="icon l" style="cursor:pointer;"><img src="'+l.getOption("pathIcons")+'/icons/download.svg" alt="download" /></span> Download</a></li>'),t.likeUrl&&(o+='<li class="like"></li>'),o+="</ul>",void 0!==t.footerText&&""!=t.footerText&&(o+='<p class="footer-text">'+t.footerText+"</p>"),o+="</div>",e.update(r,{identifier:f(t),width:i+34,dialogTitle:t.title,footerContent:o},function(e){if(!0===n.config().sharerActive&&new a({target:jQuery(e).find("li.like"),shareUrl:t.likeUrl}),jQuery(e).find('[data-toggle="tooltip"]').tooltip(),jQuery(e).find("[data-image-viewer-show-timeflowimage]").click(function(){jQuery(this).closest("ul").find("li.active").removeClass("active"),jQuery(this).closest("li").addClass("active"),jQuery(e).find(".main-image").removeClass("hide"),jQuery(e).find(".detail-load-icon").remove(),jQuery(e).find(".main-image").attr("src",jQuery(this).attr("data-image-viewer-show-timeflowimage")),jQuery(e).find(".main-image").attr("data-image-hash",jQuery(this).attr("data-detail-gen-hash")),jQuery(e).find(".main-image").attr("data-generate-src-url",jQuery(this).attr("data-image-viewer-show-timeflowimage")),jQuery(e).find(".photo-download-action").attr("href",jQuery(this).attr("data-image-viewer-download-timeflowimage"))}),u[t.category].length>1){var i=function(e){if("key"==e.data.type&&(39!=e.which&&37!=e.which||(jQuery(e.data.dialog).find("[data-image-viewer-navigation-link]").off("click",arguments.callee),jQuery(window).off("keydown",arguments.callee),39==e.which?g(e.data.category,"next"):37==e.which&&g(e.data.category,"previous"))),"click"==e.data.type){jQuery(e.data.dialog).find("[data-image-viewer-navigation-link]").off("click",arguments.callee),jQuery(e.data.dialog).find("[data-image-viewer-show-timeflowimage]").off("click",arguments.callee),jQuery(window).off("keydown",arguments.callee);var i=jQuery(this).attr("data-image-viewer-navigation-link");g(t.category,i)}};jQuery(window).on("keydown",{dialog:e,category:t.category,type:"key"},i),jQuery(e).on("hide.bs.modal",function(){jQuery(window).off("keydown",i),jQuery(e).find("[data-image-viewer-navigation-link]").off("click",i)}),jQuery(e).find("[data-image-viewer-navigation-link]").click({dialog:e,type:"click"},i)}})},p=function(t){d.info("Showing image",t),ga_track.push(["_trackEvent",l.getOption("global_event_id")+"_Features","show_"+t.category]);var i=f(t);e.visible(i)?m(t):e.showLoading({identifier:i,"close-action":"nothing"}).then(function(){if(document.getElementsByClassName("main-image"),!s.dom.query(".main-image")){var e=document.createElement("img");e.setAttribute("data-generate-src-url",t.link_generate_src),e.setAttribute("data-image-hash",t.imageHash),e.src=t.url,"detail_photos"==t.category&&(e.onerror=function(){function i(a){setTimeout(function(){o.statusMissingImage(a)?(e.style.display="none",i(a)):(e.style.display="block",e.src=t.url)},1100)}mikaImageErrorHandler(this),i(u[t.category][t.sort].imageHash)}),e.onload=function(){u[t.category][t.sort].width=e.width,u[t.category][t.sort].downloaded=!0,m(t)}}})};jQuery("[data-image-viewer-url]").each(function(e,t){var i=Math.random()*Math.random()*Math.random();jQuery(t).attr("data-image-viewer-category")&&(i=jQuery(t).attr("data-image-viewer-category")),void 0===u[i]&&(u[i]=[]);var a=u[i].length;jQuery(t).attr("data-image-viewer-sort")&&(a=parseInt(jQuery(t).attr("data-image-viewer-sort"))),u[i][a]={category:i,url:jQuery(t).attr("data-image-viewer-url"),downloadUrl:jQuery(t).attr("data-image-viewer-download-url"),title:jQuery(t).attr("data-image-viewer-title"),footerText:jQuery(t).attr("data-image-viewer-footer-text"),timeflow:jQuery(t).attr("data-image-viewer-timeflow"),link_generate_src:jQuery(t).attr("data-generate-src-url"),imageHash:jQuery(t).attr("data-image-hash"),sort:a,downloaded:!1,likeUrl:jQuery(t).attr("data-image-viewer-fb-like"),width:1340,imagePixelRatio:void 0!==jQuery(t).attr("data-image-pixel-ratio")?parseInt(jQuery(t).attr("data-image-pixel-ratio")):1},jQuery(t).click({category:i,sort:a},function(e){"none"!=jQuery(this).find(".img img:first").css("display")&&p(u[e.data.category][e.data.sort])}),!0===Boolean(jQuery(t).attr("data-image-viewer-open-on-load"))&&p(u[i][a])}),jQuery.each(u,function(e,t){void 0===c[e]&&(c[e]=0)}),d.groupCollapsed("Found Images"),d.dir(u),d.groupEnd()}),define("Mika/Timer",["Mika/Logger","Mika/Tools","module"],function(e,t,i){(new e).info("initialized: "+i.id);var a,r=new t;return a||(a=new function(){var e=0,i=function(){return e},a=function(e,i){if(i){if(-1==i.indexOf("%"))throw new Error("Please specify a valid duration format.")}else i="[%h:]%mm:%ss";var a={y:"years",d:"days",h:"hours",m:"minutes",s:"seconds"},r=[];for(var n in a)-1!=i.indexOf("%"+n)&&(r[a[n]]=!0);var o=jQuery.isPlainObject(e)?e:function(e,i){var a=e instanceof Date?e.getTime():e;if(jQuery.isPlainObject(a))return a;var r=jQuery.isPlainObject(i)&&t.getHashLength(i)>0,n={},o={years:31536e3,days:86400,hours:3600,minutes:60,seconds:1};for(var d in o)if(!r||i[d]){var l=o[d];a>=l?(n[d]=Math.floor(a/l),a-=n[d]*l):n[d]=0}return n}(e,r),d=i;for(var l in a){var s=o[a[l]],u=(s<10?"0":"")+s;d=(d=d.split("%"+l+l).join(u)).split("%"+l).join(s)}return d=d.replace(new RegExp("\\[([^\\]\\d]*[^1-9][^\\]\\d]*)+\\]","g"),""),d=d.replace(new RegExp("[\\[\\]]","g"),"")};return setInterval(function(){for(var e=r.dom.queryAll("time[datetime]"),t=0,n=e.length;t<n;t++){var o=e[t],d=new Date(Date.parse(o.getAttribute("datetime"))),l=new Date,s=0;s=o.getAttribute("data-direction")&&"up"!=o.getAttribute("data-direction")?Math.floor(Math.max(0,d.getTime()+1e3*i()+i()-l.getTime())/1e3):Math.floor((l.getTime()-d.getTime()+1e3*i())/1e3),o.innerHTML=a(s,o.getAttribute("data-format"))}},1e3),{getOffset:i,setOffset:function(t){return e=t}}}),a}),define("Mika/Mika",["Mika/Logger","Mika/Environment","module"],function(e,t,i){var a,r,n;window.console&&(console.log("%c mika: timing","color: #FFF; border-left: 50px solid #ea4d05; border-right: 50px solid #ea4d05; background: #ea4d05;"),console.log("what are you searching for?"),console.log("the cookie jar is empty!"));var o=function(n){return r=n||{},a=new e(r),jQuery("body").on("keydown",function(e){13==e.which&&jQuery("body").hasClass("modal-open")&&jQuery(".quicksearch").length>0&&0===jQuery(document.activeElement).closest(".ui-autocomplete").length&&e.stopPropagation()}),t.isMobile()&&(jQuery("body").addClass("mobile"),t.isIphone()||t.isAndroidPhone()?jQuery("body").addClass("phone"):(t.isIpad()||t.isAndroidTablet())&&jQuery("body").addClass("tablet")),!0!==i.config().debug&&!0!==i.config().display_errors&&(window.onerror=function(e){return a.error(e,arguments),!0}),{getOption:function(e){var t=i.config();return void 0!==t[e]?t[e]:null}}};return function(e){return function(e){return n||(n=new o(e),Emitter(n)),n}(e)}});